#!/bin/bash

#
# make lib を打ったときに、必要なヘッダファイルを収集するシェルスクリプト
#

SRC=$1
DST=$2

if [ -z $SRC ] || [ -z $DST ]; then
  echo "need 2 directory name"
  exit
fi

TOSCOM=../../toscom

# toscom/BUILD/ で動く時は $SRCに実体ファイルありとみなす
if [ ! -e $TOSCOM ]; then
  echo "use $SRC as TOSCOM"
  TOSCOM=$SRC
fi

HEADERS=($(ls $SRC/*.h))

for HEADER in "${HEADERS[@]}"; do
  HNAME=$(basename "$HEADER")
  if [ -e "$TOSCOM/$HNAME" ]; then
    if [[ $HNAME =~ _spec ]] || [[ $HNAME =~ _custom ]]; then
      HNAME=$SRC/$HNAME
    else
      HNAME=$TOSCOM/$HNAME
    fi
    cp $HNAME $DST
  fi
done



